%{
B = [43, 63, 83, 102, 119]*1e-3/1.5;
L = 30*1e-3

B_tot = [B B]*L
theta_440_p =  [1.8, 2.8, 3.8, 4.2, 5.2]*2*pi/360;
theta_440_m =  [1.4, 2.2, 2.8, 4.0, 4.8]*2*pi/360;
theta_440 = [theta_440_p theta_440_m];
[m, c, delta_c, delta_m] = function1(B_tot, theta_440)

delta_m/m

theta_580_p =  [2.0, 2.8, 3.6, 4.4, 5.2]*2*pi/360;
theta_580_m =  [1.6, 2.6, 3.2, 4.2, 4.8]*2*pi/360;
theta_580 = [theta_580_p theta_580_m];
[m, c, delta_c, delta_m] = function1(B_tot, theta_580)
delta_m/m

theta_595_p =  [1.8, 2.6, 3.0, 4.0, 4.4]*2*pi/360;
theta_595_m =  [1.4, 2.0, 2.8, 3.4, 4.0]*2*pi/360;
theta_595 = [theta_595_p theta_595_m];
[m, c, delta_c, delta_m] = function1(B_tot, theta_595)
delta_m/m

%}
%{
I = linspace(1.2, 2.4, 7)

chi_o = transpose([-1.58403167e-04  -1.52728118e-04 -1.57370757e-04  -1.62479688e-04  -1.56210471e-04  -1.52578463e-04 -1.55123431e-04])

chi_b = transpose([-1.58406506e-04  -1.52730931e-04 -1.57373146e-04  -1.62481658e-04  -1.56212282e-04  -1.52579952e-04 -1.55124751e-04])

m, c, delta_c, delta_m = function1(I, chi_o)
%}
H0 = (([4914.28571429,  4368.25396825,  3822.22222222,  3276.19047619,  2730.15873016, 2184.12698413,  1638.0952381,   1092.06349206,   546.03174603,     0.]))
M  = (([-0.00617547, -0.00548931, -0.00480315, -0.00411698, -0.00343082, -0.00274465, -0.00205849, -0.00137233, -0.00068616,  0.]))

plot(H0, M, 'o')
hold on 
m, c, delta_c, delta_m = function1(H0, M)
plot(H0, c + H0*m)

